<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>LDMX Software: ldmx::EventImpl Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.4 -->
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">LDMX Software</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><b>ldmx</b>      </li>
      <li class="navelem"><a class="el" href="classldmx_1_1EventImpl.html">EventImpl</a>      </li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a>  </div>
  <div class="headertitle">
<div class="title">ldmx::EventImpl Class Reference</div>  </div>
</div>
<div class="contents">
<!-- doxytag: class="ldmx::EventImpl" --><!-- doxytag: inherits="ldmx::Event" -->
<p>Implements an event buffer system for storing event data.  
 <a href="classldmx_1_1EventImpl.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="EventImpl_8h_source.html">EventImpl.h</a>&gt;</code></p>

<p><a href="classldmx_1_1EventImpl-members.html">List of all members.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1EventImpl.html#a49fd263362fed7aa7bf05a0e2d15e285">EventImpl</a> (const std::string &amp;passName)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1EventImpl.html#a63af47e9eb11d871afe5f113e352ef86">~EventImpl</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual const <a class="el" href="classldmx_1_1EventHeader.html">EventHeader</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1EventImpl.html#a445f246f88ccf5c568b4dc0a39d2ce9f">getEventHeader</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1EventImpl.html#a233c96879bfb1cfa587044074f382657">add</a> (const std::string &amp;collectionName, TClonesArray *tca)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1EventImpl.html#a0c3dcf864b50a15ac379ce408a0cf390">add</a> (const std::string &amp;name, TObject *obj)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1EventImpl.html#a113c12218ae9d3849cd43ff16b1ea8dc">addToCollection</a> (const std::string &amp;name, const TObject &amp;obj)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classldmx_1_1EventHeader.html">EventHeader</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1EventImpl.html#a492d6593e4687348368dc93aefb30941">getEventHeaderMutable</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1EventImpl.html#ae6f1975e354122aac268164fa796977b">setInputTree</a> (TTree *tree)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1EventImpl.html#a242064e84381eb6aa90a06f79404bb92">setOutputTree</a> (TTree *tree)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">TTree *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1EventImpl.html#a81f19c8688dc8929a333da06c2f3db8b">createTree</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1EventImpl.html#a6a9b5c57b33cc8e5014ff9a63e407c84">makeBranchName</a> (const std::string &amp;collectionName, const std::string &amp;passName) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1EventImpl.html#af5a17287b4e91ca7fd41cf25394e9b94">makeBranchName</a> (const std::string &amp;collectionName) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1EventImpl.html#a340a707ad6fdcec1d6abed935c6398bb">nextEvent</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1EventImpl.html#a48786bb755050e7f02c11343abe1dece">beforeFill</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1EventImpl.html#afd38a1a0a8211bb85d140badf982160d">Clear</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1EventImpl.html#abb3cff0a3cf57f48af8061ed3584e39a">onEndOfEvent</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1EventImpl.html#ae57007eaa7f3c2576e4764f45909e756">onEndOfFile</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1EventImpl.html#a0f623507858019b37b606554534185af">getPassName</a> ()</td></tr>
<tr><td colspan="2"><h2><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual const TObject *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1EventImpl.html#acb3dacb77bff7e3a01996a4b256ee8b1">getReal</a> (const std::string &amp;collectionName, const std::string &amp;passName, bool mustExist) const </td></tr>
<tr><td colspan="2"><h2><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1EventImpl.html#ab4df13f077cecf5f94b95f543eef3e50">passName_</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">std::map&lt; std::string, TBranch * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1EventImpl.html#abca186bc4f2af71cae867d45b4936dbd">branches_</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">std::map&lt; std::string, TObject * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1EventImpl.html#a3fce3d6d953cc2eab6ec3a3a6c7f6654">objects_</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">std::map&lt; std::string, TObject * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1EventImpl.html#abdfbb6c26b79879ed10199f3a313ae09">objectsOwned_</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">std::vector&lt; TBranch * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1EventImpl.html#a920a591416867a58b3aa14a258e7455d">newBranches_</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::string &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1EventImpl.html#a396a55cadee5be28915ceae4baa01c17">branchNames_</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">std::set&lt; std::string &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1EventImpl.html#a014ff80a168d22e5d017c893b0a0a08b">branchesFilled_</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">std::map&lt; std::string, <br class="typebreak"/>
std::string &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1EventImpl.html#a974e13fa2fe47ec9215242aca488f08e">knownLookups_</a></td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>Detailed Description</h2>
<div class="textblock"><p>Implements an event buffer system for storing event data. </p>
<dl class="note"><dt><b>Note:</b></dt><dd><a class="el" href="classldmx_1_1Event.html" title="Defines an interface for accessing event data.">Event</a> data is stored in ROOT trees and branches, which can be added on the fly. The same TClonesArray and TObject pointers should be used to add objects and collections from user code, as the class will add a data structure for new ones automatically. </dd></dl>

<p>Definition at line <a class="el" href="EventImpl_8h_source.html#l00037">37</a> of file <a class="el" href="EventImpl_8h_source.html">EventImpl.h</a>.</p>
</div><hr/><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a49fd263362fed7aa7bf05a0e2d15e285"></a><!-- doxytag: member="ldmx::EventImpl::EventImpl" ref="a49fd263362fed7aa7bf05a0e2d15e285" args="(const std::string &amp;passName)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ldmx::EventImpl::EventImpl </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>passName</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Class constructor. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">passName</td><td>The default pass name for adding event data. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="EventImpl_8cxx_source.html#l00016">16</a> of file <a class="el" href="EventImpl_8cxx_source.html">EventImpl.cxx</a>.</p>
<div class="fragment"><pre class="fragment">                                                     :
        <a class="code" href="classldmx_1_1EventImpl.html#ab4df13f077cecf5f94b95f543eef3e50">passName_</a>(thePassName) {
    }
</pre></div>
</div>
</div>
<a class="anchor" id="a63af47e9eb11d871afe5f113e352ef86"></a><!-- doxytag: member="ldmx::EventImpl::~EventImpl" ref="a63af47e9eb11d871afe5f113e352ef86" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ldmx::EventImpl::~EventImpl </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Class destructor. </p>

<p>Definition at line <a class="el" href="EventImpl_8cxx_source.html#l00020">20</a> of file <a class="el" href="EventImpl_8cxx_source.html">EventImpl.cxx</a>.</p>

<p>References <a class="el" href="EventImpl_8h_source.html#l00235">objectsOwned_</a>.</p>
<div class="fragment"><pre class="fragment">                          {
        <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; x : <a class="code" href="classldmx_1_1EventImpl.html#abdfbb6c26b79879ed10199f3a313ae09">objectsOwned_</a>) {
            <span class="keyword">delete</span> x.second;
        }
    }
</pre></div>
</div>
</div>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="a233c96879bfb1cfa587044074f382657"></a><!-- doxytag: member="ldmx::EventImpl::add" ref="a233c96879bfb1cfa587044074f382657" args="(const std::string &amp;collectionName, TClonesArray *tca)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ldmx::EventImpl::add </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>collectionName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TClonesArray *&#160;</td>
          <td class="paramname"><em>tca</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Adds a clones array to the event/tree. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">collectionName</td><td></td></tr>
    <tr><td class="paramname">tca</td><td>The clones array to add. </td></tr>
  </table>
  </dd>
</dl>

<p>Implements <a class="el" href="classldmx_1_1Event.html#ab5ea7b34778f5cf8d40504cdf9e69113">ldmx::Event</a>.</p>

<p>Definition at line <a class="el" href="EventImpl_8cxx_source.html#l00026">26</a> of file <a class="el" href="EventImpl_8cxx_source.html">EventImpl.cxx</a>.</p>

<p>References <a class="el" href="EventImpl_8h_source.html#l00250">branchesFilled_</a>, <a class="el" href="EventImpl_8h_source.html#l00245">branchNames_</a>, <a class="el" href="Exception_8h_source.html#l00127">EXCEPTION_RAISE</a>, <a class="el" href="EventImpl_8h_source.html#l00255">knownLookups_</a>, <a class="el" href="EventImpl_8h_source.html#l00135">makeBranchName()</a>, <a class="el" href="EventImpl_8h_source.html#l00240">newBranches_</a>, and <a class="el" href="EventImpl_8h_source.html#l00229">objects_</a>.</p>

<p>Referenced by <a class="el" href="EventImpl_8cxx_source.html#l00084">addToCollection()</a>.</p>
<div class="fragment"><pre class="fragment">                                                                          {

        <span class="keywordflow">if</span> (collectionName.find(<span class="charliteral">&#39;_&#39;</span>) != std::string::npos) {
            <a class="code" href="Exception_8h.html#a6d45ac49a0cb250fe3cabf8cf3fae7e8" title="Utility macro for throwing exceptions, automatically including the necessary file, line, and function information. The user need only supply the exception name and error message.">EXCEPTION_RAISE</a>(<span class="stringliteral">&quot;IllegalName&quot;</span>, <span class="stringliteral">&quot;The product name &#39;&quot;</span> + collectionName + <span class="stringliteral">&quot;&#39; is illegal as it contains an underscore.&quot;</span>);
        }

        std::string branchName = <a class="code" href="classldmx_1_1EventImpl.html#a6a9b5c57b33cc8e5014ff9a63e407c84">makeBranchName</a>(collectionName);

        <span class="keywordflow">if</span> (<a class="code" href="classldmx_1_1EventImpl.html#a014ff80a168d22e5d017c893b0a0a08b">branchesFilled_</a>.find(branchName) != <a class="code" href="classldmx_1_1EventImpl.html#a014ff80a168d22e5d017c893b0a0a08b">branchesFilled_</a>.end()) {
            <a class="code" href="Exception_8h.html#a6d45ac49a0cb250fe3cabf8cf3fae7e8" title="Utility macro for throwing exceptions, automatically including the necessary file, line, and function information. The user need only supply the exception name and error message.">EXCEPTION_RAISE</a>(<span class="stringliteral">&quot;ProductExists&quot;</span>, <span class="stringliteral">&quot;A product named &#39;&quot;</span> + collectionName + <span class="stringliteral">&quot;&#39; already exists in the event (has been loaded by a previous producer in this process.&quot;</span>);
        }
        <a class="code" href="classldmx_1_1EventImpl.html#a014ff80a168d22e5d017c893b0a0a08b">branchesFilled_</a>.insert(branchName);

        std::map&lt;std::string, TObject*&gt;::iterator ito = <a class="code" href="classldmx_1_1EventImpl.html#a3fce3d6d953cc2eab6ec3a3a6c7f6654">objects_</a>.find(branchName);
        <span class="keywordflow">if</span> (ito == <a class="code" href="classldmx_1_1EventImpl.html#a3fce3d6d953cc2eab6ec3a3a6c7f6654">objects_</a>.end()) { <span class="comment">// create a new branch</span>
            ito = <a class="code" href="classldmx_1_1EventImpl.html#a3fce3d6d953cc2eab6ec3a3a6c7f6654">objects_</a>.insert(std::pair&lt;std::string, TObject*&gt;(branchName, tca)).first;
            <span class="keywordflow">if</span> (outputTree_ != 0) {
                TBranch* aBranch = outputTree_-&gt;Branch(branchName.c_str(), tca, 100000, 3);
                <a class="code" href="classldmx_1_1EventImpl.html#a920a591416867a58b3aa14a258e7455d">newBranches_</a>.push_back(aBranch);
            }
            <a class="code" href="classldmx_1_1EventImpl.html#a396a55cadee5be28915ceae4baa01c17">branchNames_</a>.push_back(branchName);
            <a class="code" href="classldmx_1_1EventImpl.html#a974e13fa2fe47ec9215242aca488f08e">knownLookups_</a>.clear(); <span class="comment">// have to invalidate this cache</span>
        }
    }
</pre></div>
</div>
</div>
<a class="anchor" id="a0c3dcf864b50a15ac379ce408a0cf390"></a><!-- doxytag: member="ldmx::EventImpl::add" ref="a0c3dcf864b50a15ac379ce408a0cf390" args="(const std::string &amp;name, TObject *obj)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ldmx::EventImpl::add </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TObject *&#160;</td>
          <td class="paramname"><em>obj</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Adds a general object to the event/tree. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">name</td><td>The name of the object. </td></tr>
    <tr><td class="paramname">obj</td><td>The object to add.</td></tr>
  </table>
  </dd>
</dl>
<dl class="note"><dt><b>Note:</b></dt><dd>All objects must implement/replace TObject::Clone() to simply call "new" and create an empty new object and implement TObject::Copy() to either copy the contents of the object or swap them to the calling function, which is more efficient. </dd></dl>

<p>Implements <a class="el" href="classldmx_1_1Event.html#ac7bb740796d02e65fb42807f62f97b22">ldmx::Event</a>.</p>

<p>Definition at line <a class="el" href="EventImpl_8cxx_source.html#l00052">52</a> of file <a class="el" href="EventImpl_8cxx_source.html">EventImpl.cxx</a>.</p>

<p>References <a class="el" href="EventImpl_8h_source.html#l00250">branchesFilled_</a>, <a class="el" href="EventImpl_8h_source.html#l00245">branchNames_</a>, <a class="el" href="Exception_8h_source.html#l00127">EXCEPTION_RAISE</a>, <a class="el" href="EventImpl_8h_source.html#l00255">knownLookups_</a>, <a class="el" href="EventImpl_8h_source.html#l00135">makeBranchName()</a>, <a class="el" href="EventImpl_8h_source.html#l00240">newBranches_</a>, <a class="el" href="EventImpl_8h_source.html#l00229">objects_</a>, and <a class="el" href="EventImpl_8h_source.html#l00235">objectsOwned_</a>.</p>
<div class="fragment"><pre class="fragment">                                                                    {

        <span class="keywordflow">if</span> (collectionName.find(<span class="charliteral">&#39;_&#39;</span>)!=std::string::npos) {
            <a class="code" href="Exception_8h.html#a6d45ac49a0cb250fe3cabf8cf3fae7e8" title="Utility macro for throwing exceptions, automatically including the necessary file, line, and function information. The user need only supply the exception name and error message.">EXCEPTION_RAISE</a>(<span class="stringliteral">&quot;IllegalName&quot;</span>,<span class="stringliteral">&quot;The product name &#39;&quot;</span>+collectionName+<span class="stringliteral">&quot;&#39; is illegal as it contains an underscore.&quot;</span>);
        }

        std::string branchName;
        <span class="keywordflow">if</span> (collectionName==EventConstants::EVENT_HEADER) branchName=collectionName;
        <span class="keywordflow">else</span> branchName = <a class="code" href="classldmx_1_1EventImpl.html#a6a9b5c57b33cc8e5014ff9a63e407c84">makeBranchName</a>(collectionName);

        <span class="keywordflow">if</span> (<a class="code" href="classldmx_1_1EventImpl.html#a014ff80a168d22e5d017c893b0a0a08b">branchesFilled_</a>.find(branchName)!=<a class="code" href="classldmx_1_1EventImpl.html#a014ff80a168d22e5d017c893b0a0a08b">branchesFilled_</a>.end()) {
            <a class="code" href="Exception_8h.html#a6d45ac49a0cb250fe3cabf8cf3fae7e8" title="Utility macro for throwing exceptions, automatically including the necessary file, line, and function information. The user need only supply the exception name and error message.">EXCEPTION_RAISE</a>(<span class="stringliteral">&quot;ProductExists&quot;</span>,<span class="stringliteral">&quot;A product named &#39;&quot;</span>+collectionName+<span class="stringliteral">&quot;&#39; already exists in the event (has been loaded by a previous producer in this process.&quot;</span>);
        }
        <a class="code" href="classldmx_1_1EventImpl.html#a014ff80a168d22e5d017c893b0a0a08b">branchesFilled_</a>.insert(branchName);

        std::map&lt;std::string, TObject*&gt;::iterator ito = <a class="code" href="classldmx_1_1EventImpl.html#a3fce3d6d953cc2eab6ec3a3a6c7f6654">objects_</a>.find(branchName);

        <span class="keywordflow">if</span> (ito == <a class="code" href="classldmx_1_1EventImpl.html#a3fce3d6d953cc2eab6ec3a3a6c7f6654">objects_</a>.end()) { <span class="comment">// create a new branch</span>
            TObject* myCopy = to-&gt;Clone();
            ito = <a class="code" href="classldmx_1_1EventImpl.html#a3fce3d6d953cc2eab6ec3a3a6c7f6654">objects_</a>.insert(std::pair&lt;std::string, TObject*&gt;(branchName, myCopy)).first;
            <a class="code" href="classldmx_1_1EventImpl.html#abdfbb6c26b79879ed10199f3a313ae09">objectsOwned_</a>.insert(std::pair&lt;std::string, TObject*&gt;(branchName, myCopy));
            <span class="keywordflow">if</span> (outputTree_ != 0) {
                TBranch* aBranch = outputTree_-&gt;Branch(branchName.c_str(), myCopy);
                <a class="code" href="classldmx_1_1EventImpl.html#a920a591416867a58b3aa14a258e7455d">newBranches_</a>.push_back(aBranch);
            }
            <a class="code" href="classldmx_1_1EventImpl.html#a396a55cadee5be28915ceae4baa01c17">branchNames_</a>.push_back(branchName);
            <a class="code" href="classldmx_1_1EventImpl.html#a974e13fa2fe47ec9215242aca488f08e">knownLookups_</a>.clear(); <span class="comment">// have to invalidate this cache</span>
        }
        to-&gt;Copy(*ito-&gt;second);
    }
</pre></div>
</div>
</div>
<a class="anchor" id="a113c12218ae9d3849cd43ff16b1ea8dc"></a><!-- doxytag: member="ldmx::EventImpl::addToCollection" ref="a113c12218ae9d3849cd43ff16b1ea8dc" args="(const std::string &amp;name, const TObject &amp;obj)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ldmx::EventImpl::addToCollection </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const TObject &amp;&#160;</td>
          <td class="paramname"><em>obj</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Add the given object to the named TClonesArray collection Objects can only be added to a TClonesArray during the current pass -- TClonesArrays loaded from the input data file are not allowed to be changed. </p>
<dl class="note"><dt><b>Note:</b></dt><dd>Object types must implement TObject::Copy() </dd></dl>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">name</td><td>Name of the collection </td></tr>
    <tr><td class="paramname">obj</td><td>Object to be appended to the collection </td></tr>
  </table>
  </dd>
</dl>

<p>Implements <a class="el" href="classldmx_1_1Event.html#ab890878e2a4cefc4b95873f098079d12">ldmx::Event</a>.</p>

<p>Definition at line <a class="el" href="EventImpl_8cxx_source.html#l00084">84</a> of file <a class="el" href="EventImpl_8cxx_source.html">EventImpl.cxx</a>.</p>

<p>References <a class="el" href="EventImpl_8cxx_source.html#l00026">add()</a>, <a class="el" href="Exception_8h_source.html#l00127">EXCEPTION_RAISE</a>, <a class="el" href="EventImpl_8h_source.html#l00135">makeBranchName()</a>, and <a class="el" href="EventImpl_8h_source.html#l00235">objectsOwned_</a>.</p>
<div class="fragment"><pre class="fragment">                                                                             {
        std::string branchName;
        <span class="keywordflow">if</span> (name == EventConstants::EVENT_HEADER) <span class="keywordflow">return</span>; <span class="comment">// no adding to the event header...</span>
        branchName = <a class="code" href="classldmx_1_1EventImpl.html#a6a9b5c57b33cc8e5014ff9a63e407c84">makeBranchName</a>(name);

        <span class="keyword">auto</span> location = <a class="code" href="classldmx_1_1EventImpl.html#abdfbb6c26b79879ed10199f3a313ae09">objectsOwned_</a>.find(branchName);
        <span class="keywordflow">if</span> (location == <a class="code" href="classldmx_1_1EventImpl.html#abdfbb6c26b79879ed10199f3a313ae09">objectsOwned_</a>.end()) {
            TClonesArray* tca = <span class="keyword">new</span> TClonesArray(obj.ClassName(), 100);
            <a class="code" href="classldmx_1_1EventImpl.html#abdfbb6c26b79879ed10199f3a313ae09">objectsOwned_</a>[branchName] = tca;
            <a class="code" href="classldmx_1_1EventImpl.html#a233c96879bfb1cfa587044074f382657">add</a>(name, tca);
            TObject* to = tca-&gt;ConstructedAt(0);
            obj.Copy(*to);
        } <span class="keywordflow">else</span> {
            TClonesArray* ptca = <span class="keyword">dynamic_cast&lt;</span>TClonesArray*<span class="keyword">&gt;</span>(location-&gt;second);
            <span class="keywordflow">if</span> (ptca == 0) {
                <a class="code" href="Exception_8h.html#a6d45ac49a0cb250fe3cabf8cf3fae7e8" title="Utility macro for throwing exceptions, automatically including the necessary file, line, and function information. The user need only supply the exception name and error message.">EXCEPTION_RAISE</a>(<span class="stringliteral">&quot;ProductProblem&quot;</span>, <span class="stringliteral">&quot;Attempted to add to the collection &#39;&quot;</span> + name + <span class="stringliteral">&quot;&#39; which is not a TClonesArray.&quot;</span>);
            }
            <span class="keywordflow">if</span> (ptca-&gt;At(0)-&gt;Class() != obj.Class()) {
                <a class="code" href="Exception_8h.html#a6d45ac49a0cb250fe3cabf8cf3fae7e8" title="Utility macro for throwing exceptions, automatically including the necessary file, line, and function information. The user need only supply the exception name and error message.">EXCEPTION_RAISE</a>(<span class="stringliteral">&quot;ProductProblem&quot;</span>, <span class="stringliteral">&quot;Attempted to add object of different class to the collection &#39;&quot;</span> + name + <span class="stringliteral">&quot;&#39;&quot;</span>);
            }
            TObject* to = ptca-&gt;ConstructedAt(ptca-&gt;GetEntriesFast());
            obj.Copy(*to);
        }
    }
</pre></div>
</div>
</div>
<a class="anchor" id="a48786bb755050e7f02c11343abe1dece"></a><!-- doxytag: member="ldmx::EventImpl::beforeFill" ref="a48786bb755050e7f02c11343abe1dece" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ldmx::EventImpl::beforeFill </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Action to be executed before the tree is filled. </p>

<p>Definition at line <a class="el" href="EventImpl_8cxx_source.html#l00237">237</a> of file <a class="el" href="EventImpl_8cxx_source.html">EventImpl.cxx</a>.</p>
<div class="fragment"><pre class="fragment">                               {
        <span class="keywordflow">if</span> (inputTree_==0 &amp;&amp; <a class="code" href="classldmx_1_1EventImpl.html#a014ff80a168d22e5d017c893b0a0a08b">branchesFilled_</a>.find(EventConstants::EVENT_HEADER)==<a class="code" href="classldmx_1_1EventImpl.html#a014ff80a168d22e5d017c893b0a0a08b">branchesFilled_</a>.end()) {
            <a class="code" href="classldmx_1_1EventImpl.html#a233c96879bfb1cfa587044074f382657">add</a>(EventConstants::EVENT_HEADER, eventHeader_);
        }
    }
</pre></div>
</div>
</div>
<a class="anchor" id="afd38a1a0a8211bb85d140badf982160d"></a><!-- doxytag: member="ldmx::EventImpl::Clear" ref="afd38a1a0a8211bb85d140badf982160d" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ldmx::EventImpl::Clear </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Clear this object's data. </p>

<p>Definition at line <a class="el" href="EventImpl_8cxx_source.html#l00243">243</a> of file <a class="el" href="EventImpl_8cxx_source.html">EventImpl.cxx</a>.</p>
<div class="fragment"><pre class="fragment">                          {
        <span class="comment">// clear the event objects</span>
        <span class="keywordflow">for</span> (<span class="keyword">auto</span> obj : <a class="code" href="classldmx_1_1EventImpl.html#a3fce3d6d953cc2eab6ec3a3a6c7f6654">objects_</a>)
            obj.second-&gt;Clear(<span class="stringliteral">&quot;C&quot;</span>);
        <a class="code" href="classldmx_1_1EventImpl.html#a014ff80a168d22e5d017c893b0a0a08b">branchesFilled_</a>.clear();

    }
</pre></div>
</div>
</div>
<a class="anchor" id="a81f19c8688dc8929a333da06c2f3db8b"></a><!-- doxytag: member="ldmx::EventImpl::createTree" ref="a81f19c8688dc8929a333da06c2f3db8b" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TTree * ldmx::EventImpl::createTree </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Create the output data tree. </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>The output data tree. </dd></dl>

<p>Definition at line <a class="el" href="EventImpl_8cxx_source.html#l00206">206</a> of file <a class="el" href="EventImpl_8cxx_source.html">EventImpl.cxx</a>.</p>

<p>Referenced by <a class="el" href="EventFile_8cxx_source.html#l00162">ldmx::EventFile::setupEvent()</a>.</p>
<div class="fragment"><pre class="fragment">                                 {
        outputTree_ = <span class="keyword">new</span> TTree(<span class="stringliteral">&quot;LDMX_Events&quot;</span>, <span class="stringliteral">&quot;LDMX Events&quot;</span>);

        eventHeader_ = <span class="keyword">new</span> EventHeader();

        <span class="keywordflow">return</span> outputTree_;
    }
</pre></div>
</div>
</div>
<a class="anchor" id="a445f246f88ccf5c568b4dc0a39d2ce9f"></a><!-- doxytag: member="ldmx::EventImpl::getEventHeader" ref="a445f246f88ccf5c568b4dc0a39d2ce9f" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual const <a class="el" href="classldmx_1_1EventHeader.html">EventHeader</a>* ldmx::EventImpl::getEventHeader </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const<code> [inline, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Get the event header. </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>A constant copy of the event header. </dd></dl>

<p>Implements <a class="el" href="classldmx_1_1Event.html#a1f344b37eeb51607ae9a776145b52582">ldmx::Event</a>.</p>

<p>Definition at line <a class="el" href="EventImpl_8h_source.html#l00056">56</a> of file <a class="el" href="EventImpl_8h_source.html">EventImpl.h</a>.</p>
<div class="fragment"><pre class="fragment">                                                              {
                <span class="keywordflow">return</span> eventHeader_;
            }
</pre></div>
</div>
</div>
<a class="anchor" id="a492d6593e4687348368dc93aefb30941"></a><!-- doxytag: member="ldmx::EventImpl::getEventHeaderMutable" ref="a492d6593e4687348368dc93aefb30941" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classldmx_1_1EventHeader.html">EventHeader</a>&amp; ldmx::EventImpl::getEventHeaderMutable </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>********* Functionality for storage ********** Get a mutable copy of the <a class="el" href="classldmx_1_1EventHeader.html" title="Provides header information an event such as event number and timestamp.">EventHeader</a> object. </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>A mutable copy of the <a class="el" href="classldmx_1_1EventHeader.html" title="Provides header information an event such as event number and timestamp.">EventHeader</a> object. </dd></dl>

<p>Definition at line <a class="el" href="EventImpl_8h_source.html#l00108">108</a> of file <a class="el" href="EventImpl_8h_source.html">EventImpl.h</a>.</p>
<div class="fragment"><pre class="fragment">                                                       {
                <span class="keywordflow">return</span> *eventHeader_;
            }
</pre></div>
</div>
</div>
<a class="anchor" id="a0f623507858019b37b606554534185af"></a><!-- doxytag: member="ldmx::EventImpl::getPassName" ref="a0f623507858019b37b606554534185af" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::string ldmx::EventImpl::getPassName </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Get the current/default pass name. </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>The current/default pass name. </dd></dl>

<p>Definition at line <a class="el" href="EventImpl_8h_source.html#l00185">185</a> of file <a class="el" href="EventImpl_8h_source.html">EventImpl.h</a>.</p>

<p>References <a class="el" href="EventImpl_8h_source.html#l00194">passName_</a>.</p>
<div class="fragment"><pre class="fragment">                                    {
                <span class="keywordflow">return</span> <a class="code" href="classldmx_1_1EventImpl.html#ab4df13f077cecf5f94b95f543eef3e50">passName_</a>;
            }
</pre></div>
</div>
</div>
<a class="anchor" id="acb3dacb77bff7e3a01996a4b256ee8b1"></a><!-- doxytag: member="ldmx::EventImpl::getReal" ref="acb3dacb77bff7e3a01996a4b256ee8b1" args="(const std::string &amp;collectionName, const std::string &amp;passName, bool mustExist) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const TObject * ldmx::EventImpl::getReal </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>collectionName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>passName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>mustExist</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const<code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Get an object from the event using a custom pass name. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">collectionName</td><td>The collection name. </td></tr>
    <tr><td class="paramname">passName</td><td>The pass name. </td></tr>
  </table>
  </dd>
</dl>

<p>Implements <a class="el" href="classldmx_1_1Event.html#ab64e58638e8d1c20d672c849b1d9e71c">ldmx::Event</a>.</p>

<p>Definition at line <a class="el" href="EventImpl_8cxx_source.html#l00110">110</a> of file <a class="el" href="EventImpl_8cxx_source.html">EventImpl.cxx</a>.</p>

<p>References <a class="el" href="EventImpl_8h_source.html#l00245">branchNames_</a>, <a class="el" href="Exception_8h_source.html#l00127">EXCEPTION_RAISE</a>, <a class="el" href="EventImpl_8h_source.html#l00255">knownLookups_</a>, and <a class="el" href="EventImpl_8h_source.html#l00135">makeBranchName()</a>.</p>
<div class="fragment"><pre class="fragment">                                                                                                                      {

        std::string branchName;
        <span class="keywordflow">if</span> (collectionName== EventConstants::EVENT_HEADER) branchName=collectionName;
        <span class="keywordflow">else</span> branchName = <a class="code" href="classldmx_1_1EventImpl.html#a6a9b5c57b33cc8e5014ff9a63e407c84">makeBranchName</a>(collectionName, passName);

        <span class="keywordflow">if</span> (passName.empty() &amp;&amp; collectionName!= EventConstants::EVENT_HEADER) {
            <span class="keyword">auto</span> ptr=<a class="code" href="classldmx_1_1EventImpl.html#a974e13fa2fe47ec9215242aca488f08e">knownLookups_</a>.find(collectionName);
            <span class="keywordflow">if</span> (ptr!=<a class="code" href="classldmx_1_1EventImpl.html#a974e13fa2fe47ec9215242aca488f08e">knownLookups_</a>.end()) branchName=ptr-&gt;second;
            <span class="keywordflow">else</span> {
                std::vector&lt;std::vector&lt;std::string&gt;::const_iterator&gt; matches;
                branchName=collectionName+<span class="stringliteral">&quot;_&quot;</span>;
                for (std::vector&lt;std::string&gt;::const_iterator ptr=<a class="code" href="classldmx_1_1EventImpl.html#a396a55cadee5be28915ceae4baa01c17">branchNames_</a>.begin(); ptr!=<a class="code" href="classldmx_1_1EventImpl.html#a396a55cadee5be28915ceae4baa01c17">branchNames_</a>.end(); ptr++) {
                    <span class="keywordflow">if</span> (!ptr-&gt;compare(0,branchName.size(),branchName)) matches.push_back(ptr);
                }
                <span class="keywordflow">if</span> (matches.empty()) {
                    <span class="keywordflow">if</span> (!mustExist)
                        <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;
                    <a class="code" href="Exception_8h.html#a6d45ac49a0cb250fe3cabf8cf3fae7e8" title="Utility macro for throwing exceptions, automatically including the necessary file, line, and function information. The user need only supply the exception name and error message.">EXCEPTION_RAISE</a>(<span class="stringliteral">&quot;ProductNotFound&quot;</span>,<span class="stringliteral">&quot;No product found for name &#39;&quot;</span>+collectionName+<span class="stringliteral">&quot;&#39;&quot;</span>);
                } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (matches.size()&gt;1) {
                    std::string names;
                    <span class="keywordflow">for</span> (<span class="keyword">auto</span> strs : matches) {
                        <span class="keywordflow">if</span> (!names.empty()) names+=<span class="stringliteral">&quot;, &quot;</span>;
                        names+=*strs;
                    }
                    <span class="keywordflow">if</span> (!mustExist)
                        <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;
                    <a class="code" href="Exception_8h.html#a6d45ac49a0cb250fe3cabf8cf3fae7e8" title="Utility macro for throwing exceptions, automatically including the necessary file, line, and function information. The user need only supply the exception name and error message.">EXCEPTION_RAISE</a>(<span class="stringliteral">&quot;ProductAmbiguous&quot;</span>,<span class="stringliteral">&quot;Multiple products found for name &#39;&quot;</span>+collectionName+<span class="stringliteral">&quot;&#39; without specified pass name (&quot;</span>+names+<span class="stringliteral">&quot;)&quot;</span>);
                } <span class="keywordflow">else</span> {
                    branchName=*matches.front();
                    <a class="code" href="classldmx_1_1EventImpl.html#a974e13fa2fe47ec9215242aca488f08e">knownLookups_</a>[collectionName]=branchName;
                }
            }
        }


        std::map&lt;std::string, TBranch*&gt;::const_iterator itb = <a class="code" href="classldmx_1_1EventImpl.html#abca186bc4f2af71cae867d45b4936dbd">branches_</a>.find(branchName);

        <span class="comment">// check the objects map</span>
        std::map&lt;std::string, TObject*&gt;::const_iterator ito = <a class="code" href="classldmx_1_1EventImpl.html#a3fce3d6d953cc2eab6ec3a3a6c7f6654">objects_</a>.find(branchName);
        <span class="keywordflow">if</span> (ito != <a class="code" href="classldmx_1_1EventImpl.html#a3fce3d6d953cc2eab6ec3a3a6c7f6654">objects_</a>.end()) {
           <span class="keywordflow">if</span> (itb!=<a class="code" href="classldmx_1_1EventImpl.html#abca186bc4f2af71cae867d45b4936dbd">branches_</a>.end())
              itb-&gt;second-&gt;GetEntry(ientry_);
           <span class="keywordflow">return</span> ito-&gt;second;
        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (inputTree_ == 0) {
            <a class="code" href="Exception_8h.html#a6d45ac49a0cb250fe3cabf8cf3fae7e8" title="Utility macro for throwing exceptions, automatically including the necessary file, line, and function information. The user need only supply the exception name and error message.">EXCEPTION_RAISE</a>(<span class="stringliteral">&quot;ProductNotFound&quot;</span>, <span class="stringliteral">&quot;No product found for name &#39;&quot;</span> + collectionName + <span class="stringliteral">&quot;&#39; and pass &#39;&quot;</span> + <a class="code" href="classldmx_1_1EventImpl.html#ab4df13f077cecf5f94b95f543eef3e50">passName_</a> + <span class="stringliteral">&quot;&#39;&quot;</span>);
        }

        <span class="comment">// find the active branch and update if necessary</span>
        <span class="keywordflow">if</span> (itb != <a class="code" href="classldmx_1_1EventImpl.html#abca186bc4f2af71cae867d45b4936dbd">branches_</a>.end()) {

            std::map&lt;std::string, TObject*&gt;::iterator ito = <a class="code" href="classldmx_1_1EventImpl.html#a3fce3d6d953cc2eab6ec3a3a6c7f6654">objects_</a>.find(branchName);

            <span class="comment">// update buffers if needed</span>
            <span class="keywordflow">if</span> (itb-&gt;second-&gt;GetReadEntry() != ientry_) {

                TBranchElement* tbe = <span class="keyword">dynamic_cast&lt;</span>TBranchElement*<span class="keyword">&gt;</span>(itb-&gt;second);
                <span class="keywordflow">if</span> (!tbe)
                    itb-&gt;second-&gt;SetAddress(ito-&gt;second);
                <span class="keywordtype">int</span> nr = itb-&gt;second-&gt;GetEntry(ientry_, 1);
            }

            <span class="comment">// check the objects map</span>

            <span class="keywordflow">if</span> (ito != <a class="code" href="classldmx_1_1EventImpl.html#a3fce3d6d953cc2eab6ec3a3a6c7f6654">objects_</a>.end())
                <span class="keywordflow">return</span> ito-&gt;second;

            <span class="comment">// this case is hard to achieve</span>
            <span class="keywordflow">return</span> 0;
        } <span class="keywordflow">else</span> {

            <span class="comment">// ok, maybe we&#39;ve not loaded this yet, look for a branch</span>
            TBranch* branch = inputTree_-&gt;GetBranch(branchName.c_str());
            <span class="keywordflow">if</span> (branch == 0) {
                <a class="code" href="Exception_8h.html#a6d45ac49a0cb250fe3cabf8cf3fae7e8" title="Utility macro for throwing exceptions, automatically including the necessary file, line, and function information. The user need only supply the exception name and error message.">EXCEPTION_RAISE</a>(<span class="stringliteral">&quot;ProductNotFound&quot;</span>, <span class="stringliteral">&quot;No product found for name &#39;&quot;</span> + collectionName + <span class="stringliteral">&quot;&#39; and pass &#39;&quot;</span> + <a class="code" href="classldmx_1_1EventImpl.html#ab4df13f077cecf5f94b95f543eef3e50">passName_</a> + <span class="stringliteral">&quot;&#39;&quot;</span>);
            }

            <span class="comment">// ooh, new branch!</span>
            TObject* top(0);
            branch-&gt;SetAutoDelete(<span class="keyword">false</span>);
            branch-&gt;SetStatus(1);
            branch-&gt;GetEntry((ientry_&lt;0)?(0):(ientry_));
            TBranchElement* tbe = <span class="keyword">dynamic_cast&lt;</span>TBranchElement*<span class="keyword">&gt;</span>(branch);
            <span class="keywordflow">if</span> (tbe) {
                top = (TObject*) tbe-&gt;GetObject();
            } <span class="keywordflow">else</span> {
                branch-&gt;SetAddress(&amp;top);
            }

            <a class="code" href="classldmx_1_1EventImpl.html#abca186bc4f2af71cae867d45b4936dbd">branches_</a>.insert(std::pair&lt;std::string, TBranch*&gt;(branchName, branch));
            <a class="code" href="classldmx_1_1EventImpl.html#a3fce3d6d953cc2eab6ec3a3a6c7f6654">objects_</a>.insert(std::pair&lt;std::string, TObject*&gt;(branchName, top));

            <span class="keywordflow">return</span> top;
        }
    }
</pre></div>
</div>
</div>
<a class="anchor" id="a6a9b5c57b33cc8e5014ff9a63e407c84"></a><!-- doxytag: member="ldmx::EventImpl::makeBranchName" ref="a6a9b5c57b33cc8e5014ff9a63e407c84" args="(const std::string &amp;collectionName, const std::string &amp;passName) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::string ldmx::EventImpl::makeBranchName </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>collectionName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>passName</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Make a branch name from a collection and pass name. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">collectionName</td><td>The collection name. </td></tr>
    <tr><td class="paramname">passName</td><td>The pass name. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="EventImpl_8h_source.html#l00135">135</a> of file <a class="el" href="EventImpl_8h_source.html">EventImpl.h</a>.</p>

<p>Referenced by <a class="el" href="EventImpl_8cxx_source.html#l00026">add()</a>, <a class="el" href="EventImpl_8cxx_source.html#l00084">addToCollection()</a>, <a class="el" href="EventImpl_8cxx_source.html#l00110">getReal()</a>, and <a class="el" href="EventImpl_8h_source.html#l00143">makeBranchName()</a>.</p>
<div class="fragment"><pre class="fragment">                                                                                                       {
                <span class="keywordflow">return</span> collectionName + <span class="stringliteral">&quot;_&quot;</span> + passName;
            }
</pre></div>
</div>
</div>
<a class="anchor" id="af5a17287b4e91ca7fd41cf25394e9b94"></a><!-- doxytag: member="ldmx::EventImpl::makeBranchName" ref="af5a17287b4e91ca7fd41cf25394e9b94" args="(const std::string &amp;collectionName) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::string ldmx::EventImpl::makeBranchName </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>collectionName</em></td><td>)</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Make a branch name from a collection and the default(current) pass name. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">collectionName</td><td>The collection name. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="EventImpl_8h_source.html#l00143">143</a> of file <a class="el" href="EventImpl_8h_source.html">EventImpl.h</a>.</p>

<p>References <a class="el" href="EventImpl_8h_source.html#l00135">makeBranchName()</a>, and <a class="el" href="EventImpl_8h_source.html#l00194">passName_</a>.</p>
<div class="fragment"><pre class="fragment">                                                                            {
                <span class="keywordflow">return</span> <a class="code" href="classldmx_1_1EventImpl.html#a6a9b5c57b33cc8e5014ff9a63e407c84">makeBranchName</a>(collectionName, <a class="code" href="classldmx_1_1EventImpl.html#ab4df13f077cecf5f94b95f543eef3e50">passName_</a>);
            }
</pre></div>
</div>
</div>
<a class="anchor" id="a340a707ad6fdcec1d6abed935c6398bb"></a><!-- doxytag: member="ldmx::EventImpl::nextEvent" ref="a340a707ad6fdcec1d6abed935c6398bb" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool ldmx::EventImpl::nextEvent </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Go to the next event by incrementing the entry index. </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>Hard-coded to return true. </dd></dl>

<p>Definition at line <a class="el" href="EventImpl_8cxx_source.html#l00231">231</a> of file <a class="el" href="EventImpl_8cxx_source.html">EventImpl.cxx</a>.</p>
<div class="fragment"><pre class="fragment">                              {
        ientry_++;
        eventHeader_=get&lt;EventHeader*&gt;(EventConstants::EVENT_HEADER);
        <span class="keywordflow">return</span> <span class="keyword">true</span>;
    }
</pre></div>
</div>
</div>
<a class="anchor" id="abb3cff0a3cf57f48af8061ed3584e39a"></a><!-- doxytag: member="ldmx::EventImpl::onEndOfEvent" ref="abb3cff0a3cf57f48af8061ed3584e39a" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ldmx::EventImpl::onEndOfEvent </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Perform end of event action (clears the owned objects). </p>

<p>Definition at line <a class="el" href="EventImpl_8cxx_source.html#l00250">250</a> of file <a class="el" href="EventImpl_8cxx_source.html">EventImpl.cxx</a>.</p>
<div class="fragment"><pre class="fragment">                                 {
        <a class="code" href="classldmx_1_1EventImpl.html#a014ff80a168d22e5d017c893b0a0a08b">branchesFilled_</a>.clear();
    }
</pre></div>
</div>
</div>
<a class="anchor" id="ae57007eaa7f3c2576e4764f45909e756"></a><!-- doxytag: member="ldmx::EventImpl::onEndOfFile" ref="ae57007eaa7f3c2576e4764f45909e756" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ldmx::EventImpl::onEndOfFile </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Perform end of file action (doesn't do anything right now). </p>

<p>Definition at line <a class="el" href="EventImpl_8cxx_source.html#l00254">254</a> of file <a class="el" href="EventImpl_8cxx_source.html">EventImpl.cxx</a>.</p>
<div class="fragment"><pre class="fragment">                                {
    }
</pre></div>
</div>
</div>
<a class="anchor" id="ae6f1975e354122aac268164fa796977b"></a><!-- doxytag: member="ldmx::EventImpl::setInputTree" ref="ae6f1975e354122aac268164fa796977b" args="(TTree *tree)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ldmx::EventImpl::setInputTree </td>
          <td>(</td>
          <td class="paramtype">TTree *&#160;</td>
          <td class="paramname"><em>tree</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Set the input data tree. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">tree</td><td>The input data tree. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="EventImpl_8cxx_source.html#l00218">218</a> of file <a class="el" href="EventImpl_8cxx_source.html">EventImpl.cxx</a>.</p>
<div class="fragment"><pre class="fragment">                                            {
        inputTree_ = tree;
        entries_ = inputTree_-&gt;GetEntriesFast();
        <a class="code" href="classldmx_1_1EventImpl.html#a396a55cadee5be28915ceae4baa01c17">branchNames_</a>.clear();


        <span class="comment">// find the names of all the existing branches</span>
        TObjArray* branches = inputTree_-&gt;GetListOfBranches();
        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; branches-&gt;GetEntriesFast(); i++) {
            <a class="code" href="classldmx_1_1EventImpl.html#a396a55cadee5be28915ceae4baa01c17">branchNames_</a>.push_back(branches-&gt;At(i)-&gt;GetName());
        }
    }
</pre></div>
</div>
</div>
<a class="anchor" id="a242064e84381eb6aa90a06f79404bb92"></a><!-- doxytag: member="ldmx::EventImpl::setOutputTree" ref="a242064e84381eb6aa90a06f79404bb92" args="(TTree *tree)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ldmx::EventImpl::setOutputTree </td>
          <td>(</td>
          <td class="paramtype">TTree *&#160;</td>
          <td class="paramname"><em>tree</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Set the output data tree. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">tree</td><td>The output data tree. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="EventImpl_8cxx_source.html#l00214">214</a> of file <a class="el" href="EventImpl_8cxx_source.html">EventImpl.cxx</a>.</p>
<div class="fragment"><pre class="fragment">                                             {
        outputTree_ = tree;
    }
</pre></div>
</div>
</div>
<hr/><h2>Member Data Documentation</h2>
<a class="anchor" id="abca186bc4f2af71cae867d45b4936dbd"></a><!-- doxytag: member="ldmx::EventImpl::branches_" ref="abca186bc4f2af71cae867d45b4936dbd" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::map&lt;std::string, TBranch*&gt; <a class="el" href="classldmx_1_1EventImpl.html#abca186bc4f2af71cae867d45b4936dbd">ldmx::EventImpl::branches_</a><code> [mutable, private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>The output tree for writing a new file. The input tree for reading existing data. Map of names to branches. </p>

<p>Definition at line <a class="el" href="EventImpl_8h_source.html#l00214">214</a> of file <a class="el" href="EventImpl_8h_source.html">EventImpl.h</a>.</p>

</div>
</div>
<a class="anchor" id="a014ff80a168d22e5d017c893b0a0a08b"></a><!-- doxytag: member="ldmx::EventImpl::branchesFilled_" ref="a014ff80a168d22e5d017c893b0a0a08b" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::set&lt;std::string&gt; <a class="el" href="classldmx_1_1EventImpl.html#a014ff80a168d22e5d017c893b0a0a08b">ldmx::EventImpl::branchesFilled_</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Names of branches filled during this event. </p>

<p>Definition at line <a class="el" href="EventImpl_8h_source.html#l00250">250</a> of file <a class="el" href="EventImpl_8h_source.html">EventImpl.h</a>.</p>

<p>Referenced by <a class="el" href="EventImpl_8cxx_source.html#l00026">add()</a>.</p>

</div>
</div>
<a class="anchor" id="a396a55cadee5be28915ceae4baa01c17"></a><!-- doxytag: member="ldmx::EventImpl::branchNames_" ref="a396a55cadee5be28915ceae4baa01c17" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;std::string&gt; <a class="el" href="classldmx_1_1EventImpl.html#a396a55cadee5be28915ceae4baa01c17">ldmx::EventImpl::branchNames_</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Names of all branches. </p>

<p>Definition at line <a class="el" href="EventImpl_8h_source.html#l00245">245</a> of file <a class="el" href="EventImpl_8h_source.html">EventImpl.h</a>.</p>

<p>Referenced by <a class="el" href="EventImpl_8cxx_source.html#l00026">add()</a>, and <a class="el" href="EventImpl_8cxx_source.html#l00110">getReal()</a>.</p>

</div>
</div>
<a class="anchor" id="a974e13fa2fe47ec9215242aca488f08e"></a><!-- doxytag: member="ldmx::EventImpl::knownLookups_" ref="a974e13fa2fe47ec9215242aca488f08e" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::map&lt;std::string, std::string&gt; <a class="el" href="classldmx_1_1EventImpl.html#a974e13fa2fe47ec9215242aca488f08e">ldmx::EventImpl::knownLookups_</a><code> [mutable, private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Efficiency cache for empty pass name lookups. </p>

<p>Definition at line <a class="el" href="EventImpl_8h_source.html#l00255">255</a> of file <a class="el" href="EventImpl_8h_source.html">EventImpl.h</a>.</p>

<p>Referenced by <a class="el" href="EventImpl_8cxx_source.html#l00026">add()</a>, and <a class="el" href="EventImpl_8cxx_source.html#l00110">getReal()</a>.</p>

</div>
</div>
<a class="anchor" id="a920a591416867a58b3aa14a258e7455d"></a><!-- doxytag: member="ldmx::EventImpl::newBranches_" ref="a920a591416867a58b3aa14a258e7455d" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;TBranch*&gt; <a class="el" href="classldmx_1_1EventImpl.html#a920a591416867a58b3aa14a258e7455d">ldmx::EventImpl::newBranches_</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>List of new branches added. </p>

<p>Definition at line <a class="el" href="EventImpl_8h_source.html#l00240">240</a> of file <a class="el" href="EventImpl_8h_source.html">EventImpl.h</a>.</p>

<p>Referenced by <a class="el" href="EventImpl_8cxx_source.html#l00026">add()</a>.</p>

</div>
</div>
<a class="anchor" id="a3fce3d6d953cc2eab6ec3a3a6c7f6654"></a><!-- doxytag: member="ldmx::EventImpl::objects_" ref="a3fce3d6d953cc2eab6ec3a3a6c7f6654" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::map&lt;std::string, TObject*&gt; <a class="el" href="classldmx_1_1EventImpl.html#a3fce3d6d953cc2eab6ec3a3a6c7f6654">ldmx::EventImpl::objects_</a><code> [mutable, private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Map of names to objects. </p>

<p>Definition at line <a class="el" href="EventImpl_8h_source.html#l00229">229</a> of file <a class="el" href="EventImpl_8h_source.html">EventImpl.h</a>.</p>

<p>Referenced by <a class="el" href="EventImpl_8cxx_source.html#l00026">add()</a>.</p>

</div>
</div>
<a class="anchor" id="abdfbb6c26b79879ed10199f3a313ae09"></a><!-- doxytag: member="ldmx::EventImpl::objectsOwned_" ref="abdfbb6c26b79879ed10199f3a313ae09" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::map&lt;std::string, TObject*&gt; <a class="el" href="classldmx_1_1EventImpl.html#abdfbb6c26b79879ed10199f3a313ae09">ldmx::EventImpl::objectsOwned_</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Map of owned objects that should eventually be cleared at end of event and deleted when this object is destroyed. </p>

<p>Definition at line <a class="el" href="EventImpl_8h_source.html#l00235">235</a> of file <a class="el" href="EventImpl_8h_source.html">EventImpl.h</a>.</p>

<p>Referenced by <a class="el" href="EventImpl_8cxx_source.html#l00052">add()</a>, <a class="el" href="EventImpl_8cxx_source.html#l00084">addToCollection()</a>, and <a class="el" href="EventImpl_8cxx_source.html#l00020">~EventImpl()</a>.</p>

</div>
</div>
<a class="anchor" id="ab4df13f077cecf5f94b95f543eef3e50"></a><!-- doxytag: member="ldmx::EventImpl::passName_" ref="ab4df13f077cecf5f94b95f543eef3e50" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::string <a class="el" href="classldmx_1_1EventImpl.html#ab4df13f077cecf5f94b95f543eef3e50">ldmx::EventImpl::passName_</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>The event header object (as pointer). Number of entries in the tree. Current entry in the tree. The default pass name. </p>

<p>Definition at line <a class="el" href="EventImpl_8h_source.html#l00194">194</a> of file <a class="el" href="EventImpl_8h_source.html">EventImpl.h</a>.</p>

<p>Referenced by <a class="el" href="EventImpl_8h_source.html#l00185">getPassName()</a>, and <a class="el" href="EventImpl_8h_source.html#l00143">makeBranchName()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>Framework/include/Framework/<a class="el" href="EventImpl_8h_source.html">EventImpl.h</a></li>
<li>Framework/src/<a class="el" href="EventImpl_8cxx_source.html">EventImpl.cxx</a></li>
</ul>
</div>
<hr class="footer"/><address class="footer"><small>Generated by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.4 </small></address>
</body>
</html>
